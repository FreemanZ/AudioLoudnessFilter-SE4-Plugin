# 音频响度过滤器插件项目

## 项目概述

这是一个为SubtitleEdit 4.0.13开发的音频响度过滤器插件，可以根据音频响度自动删除低响度的字幕行。

## 项目结构

### 核心文件
- **`AudioLoudnessFilter_SE4_Tool.cs`** - 主插件文件（工具版本）
- **`AudioLoudnessAnalyzer_SE4.cs`** - 音频分析器
- **`IPlugin_SE4_Official.cs`** - 官方插件接口定义
- **`TestPlugin_SE4_Official.cs`** - 测试插件
- **`AudioLoudnessFilter_SE4_Official.csproj`** - 项目文件

### 安装脚本
- **`install-tool-plugin.bat`** - 工具插件安装脚本

### 文档
- **`工具插件使用说明.md`** - 详细使用说明
- **`项目说明.md`** - 本文件

### SE4源代码
- **`SE4/`** - SubtitleEdit 4.0.13完整源代码

## 插件特点

### 1. 工具菜单集成
- 插件出现在SubtitleEdit的"工具"菜单中
- 点击后显示独立的插件窗口

### 2. 功能完整
- 支持多种音频格式（WAV、MP3、AAC、FLAC、OGG）
- 可配置响度阈值（默认-45dB）
- 实时处理日志显示
- 预览删除的字幕行
- 自动解析SRT字幕格式

### 3. 用户友好
- 完全中文界面
- 实时进度显示
- 详细的错误处理
- 操作日志记录

## 技术规格

- **目标框架**: .NET Framework 4.8
- **音频分析**: RMS算法计算响度
- **插件接口**: 符合SubtitleEdit 4.0.13官方规范
- **命名空间**: `Nikse.SubtitleEdit.PluginLogic`

## 安装路径

插件安装到SubtitleEdit的默认路径：
- **主程序**: `C:\Program Files\Subtitle Edit\`
- **插件目录**: `C:\Program Files\Subtitle Edit\Plugins\`

## 使用方法

1. **编译插件**：
   ```batch
   dotnet build AudioLoudnessFilter_SE4_Official.csproj --configuration Release
   ```

2. **安装插件**：
   ```batch
   install-tool-plugin.bat
   ```

3. **使用插件**：
   - 启动SubtitleEdit 4.0.13
   - 打开字幕文件
   - 在"工具"菜单中点击"音频响度过滤器"
   - 在插件窗口中加载音频文件并处理

## 开发环境

- **.NET Framework 4.8**
- **NAudio 2.1.0** - 音频处理库
- **System.Windows.Forms** - 用户界面
- **System.Drawing** - 图形处理

## 项目历史

此项目经过多次迭代，最终版本为工具菜单版本，提供了完整的用户界面和功能。

## 注意事项

- 确保SubtitleEdit 4.0.13已正确安装
- 插件需要音频文件与字幕文件时间同步
- 建议在处理前备份原始字幕文件
